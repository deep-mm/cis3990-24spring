<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Title -->
    <title>CIS7000 Lab 0</title>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css"
        integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">
    <!-- Custom styles for this template -->
    <link href="css/styles.css" rel="stylesheet">
    <link href="css/scrolling-nav.css" rel="stylesheet">
    <!-- For code -->
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-light.min.css" />
    <link rel="stylesheet"
        href="https://www.cis.upenn.edu/~mingminz/courses/cis3990-24s/lab0/stylesheets/stylesheet.css" />
    <style>
        code {
            white-space: pre-wrap;
        }

        span.smallcaps {
            font-variant: small-caps;
        }

        span.underline {
            text-decoration: underline;
        }

        div.column {
            display: inline-block;
            vertical-align: top;
            width: 50%;
        }

        div.hanging-indent {
            margin-left: 1.5em;
            text-indent: -1.5em;
        }

        ul.task-list {
            list-style: none;
        }

        code.language-swift {
            font-size: 13px;
            /* Adjust font size as needed */
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>


<body id="main">
    <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-penn-blue">
        <div class="container">
            <a class="navbar-brand js-scroll-trigger" href="../index.html">CIS7000</a>
            <a class="navbar-brand js-scroll-trigger" href="index.html#main">Home</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggle">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarToggle">
                <ul class="navbar-nav ml-auto">
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="index.html#layout">Xcode's Layout</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="index.html#xcode-shortcuts">Xcode Shortcuts</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="index.html#assignment">Lab Assignment</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link js-scroll-trigger" href="index.html#submission">Submission Instructions</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container" style="padding-top: 20px; padding-bottom: 20px">
        <div class="section">
            <p />
            <h1 style="font-size: 32px">Lab 0</h1>
            <p />
            <!-- <div><span class="title">Assigned: </span>TBD</div>
            <div><span class="title">Due: </span>TBD</div> -->
            <p />
            <p>In this lab, we cover the basics of the Xcode IDE, the iOS Simulator, Xcode's Documentation Viewer, and
                the Swift programming language. By the end of lab, we'll have built a simple iPhone application that
                displays weather from the <a href="https://openweathermap.org/current">OpenWeather</a> API.</p>
            <p>To complete this lab, you'll need to download <a
                    href="macappstores://itunes.apple.com/us/app/xcode/id497799835">Xcode</a>.</p>
        </div>
    </div>


    <div class="container">
        <h5 id="layout">Xcode's Layout</h5>
        First, a little about Xcode's layout (note this is slightly dated, but the current layout remains very similar):
        <p><img src="img/layout.jpg"
                title="panels: left: navigator, top: menu, right: utilities (right top: inspector, right bottom: library) bottom: debugger (bottom left:variables, bottom right:console)"
                width="600" height="700" /></p>
    </div>
    <br>

    <div class="container" style="padding-bottom: 10px;">
        <h5 id="xcode-shortcuts">Xcode Shortcuts</h5>
        Some helpful Xcode shortcuts and tips
        <table border="1" height="200">
            <tbody>
                <tr class="odd">
                    <td style="text-align: left;">View Documentation:</td>
                    <td style="text-align: left;">⌥+Click</td>
                </tr>
                <tr class="even">
                    <td style="text-align: left;">Open Docs:</td>
                    <td style="text-align: left;">⇧⌘<span style="font-family:Monaco;">0</span></td>
                </tr>
                <tr class="odd">
                    <td style="text-align: left;">Go to Definition:</td>
                    <td style="text-align: left;">⌘+Click</td>
                </tr>
                <tr class="even">
                    <td style="text-align: left;">Open file Quickly:</td>
                    <td style="text-align: left;">⇧⌘O</td>
                </tr>
            </tbody>
        </table>
        <br>
        Some helpful iOS Simulator shortcuts and tips
        <table border="1" height="200">
            <tbody>
                <tr class="odd">
                    <td style="text-align: left;">Press Home Button:</td>
                    <td style="text-align: left;">⇧⌘H</td>
                </tr>
                <tr class="even">
                    <td style="text-align: left;">Rotate Left</td>
                    <td style="text-align: left;">⌘←</td>
                </tr>
                <tr class="odd">
                    <td style="text-align: left;">Rotate Right</td>
                    <td style="text-align: left;">⌘→</td>
                </tr>
                <tr class="even">
                    <td style="text-align: left;">If the keyboard isn't appearing/disappearing as expected:</td>
                    <td style="text-align: left;">⌘K</td>
                </tr>
            </tbody>
        </table>
        <br>
        <p>⌘ = Command | ⌥ = Option | ⇧ = Shift</p>
        <p>You may check <a href="https://docs.swift.org/swift-book/GuidedTour/GuidedTour.html">Apple's Swift Tour</a>
            or <a href="https://docs.swift.org/swift-book/LanguageGuide/TheBasics.html">Apple's Swift basics</a> for
            details.</p>
    </div>

    <div class="container">
        <h5 id="assignment">Lab Assignment</h5>
        <p><img src="img/api.gif" alt="GIF Image" width="250" /></p>
        <p>You're building an app that basically loads the weather.</p>
        <p>The fetchWeather is asynchronous. If there's no network, the app shouldn't hang or crash.</p>
        <p>We've recorded videos with instructions on how to complete the lab in Swift. (The videos have no sound.) The
            goal is to get you comfortable with Xcode, the docs, the simulator, and Swift.</p>
        <p>The videos build off of one another. You can do the assignment in your own way, or in the exact way it's done
            in the videos. It's entirely up to you.</p>
        <p>The videos were recorded a few years ago, so some details about XCode's user inferface and Swift have
            changed. Also, the recordings were based on Wunderground API, which is <b>no longer available</b>. We suggest using
            the <a href="https://openweathermap.org/api">OpenWeather</a> API to get current weather conditions instead.
            You can see an example JSON response in <a href="https://openweathermap.org/current">OpenWeather
                documentation</a>. We have noted changes for each video, if applicable, at the description before the
            corresponding video.</p>

        <h5 id="video-1---hello-world">Video 1 - Hello World</h5>
        <p>We create the project and print "Hello World". You'll also notice that we resize the simulator, and click on
            some of the menu bars. This just so that you see what those buttons do.</p>
        <p>When creating a project, first select “App” (you won't see single-view application), then select "Storyboard"
            for "User Inferface". Another option is "SwiftUI", which is actually a newer method but is not compatible
            with the tutorial videos.</p>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/qYklGQAuZ5Q" frameborder="0"
            allowfullscreen>
        </iframe>
        <p>Make sure you choose iOS when creating a new project. (DO NOT use macOS).</p>
        <p>Why? The default life cycle in iOS is UIkit while macOS uses Cocoa.</p>
        <p>What is the difference between them?</p>
        <p>Read more here: <a
                href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CocoaFundamentals/WhatIsCocoa/WhatIsCocoa.html">Cocoa</a>
            and <a href="https://developer.apple.com/documentation/uikit">UIkit</a>.</p>
        <p><img src="img/v1.1.jpg" alt="new project" width="500" height="300" /></p>
        <p>General setting in lab0 for latest Xcode.</p>
        <p><img src="img/v1.2.jpg" alt="setting" width="500" /></p>
        <hr />
        <hr />

        <h5 id="video-2---making-a-weather-class">Video 2 - Making a <code>Weather</code> Class</h5>
        <p>Here, we define a weather class with some properties and methods.</p>
        <p><strong>Changes:</strong></p>
        <ul>
            <li>You will notice that the rest of the videos test/simulate on an iPhone. You should simulate on the
                device that is most similar to the one you will be using for hardware (e.g. if you plan to upload live
                code to an iPad, simulate on an iPad).</li>
        </ul>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/Jvjs8ePFl2Y?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <hr />
        <hr />

        <h5 id="video-3---flushing-out-the-weather-methods">Video 3 - Flushing out the <code>Weather</code> Methods</h5>
        <p>We add some details to the weather methods from the previous video. In the next video, we instantiate the
            weather class, and debug it. This video contains an intentional error. We'll debug it in the next one.</p>
        <p><strong>Changes:</strong></p>
        <ul>
            <li>
                <p>Make sure to update the URLs and APP IDs with the ones you receive from OpenWeather. More details can
                    be found on the <a href="https://openweathermap.org/current">documentation</a></p>
            </li>
            <li>
                <p>The url string is
                    <code>"https://api.openweathermap.org/data/2.5/weather?zip=\(zip)&amp;appid=\(APP_ID)&amp;units=imperial"</code>.
                </p>
            </li>
            <li>
                <p>Create an API key by registering on the website for the free plan. You will receive an API Key in
                    your email.</p>
            </li>
            <li>
                <p>You may need to update some of the response field names if OpenWeather doesn't provide them (e.g.
                    windString). The specifics of which fields you are displaying aren't super important (you need to at
                    least have the current temp) - just include 4-5 different ones like humidity, wind speed, etc.</p>
            </li>
        </ul>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/YYCasqQWSnU?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <p>How to generate your own APP IDs?</p>
        <p>Create an account with your email and you will find you own id under your account -> My API keys</p>
        <p><img src="img/v3.1.jpg" alt="account" width="700" /></p>
        <hr />
        <hr />

        <h5 id="video-4---instantiating-and-debugging-weather">Video 4 - Instantiating and Debugging
            <code>Weather</code>
        </h5>
        <p>There was an error with weather. We illustrate some of the tools the debugger has.</p>
        <p>Using the debugger will make your life much, much easier, and we think it's worth learning.</p>
        <p><strong>Changes:</strong> Take a look at an example JSON response in <a
                href="https://openweathermap.org/current#parameter">OpenWeather API documentation</a>.</p>
        <ul>
            <li>
                <p>The correct key for JSON is <code>"main"</code>, instead of <code>"current_observation"</code>.</p>
            </li>
            <li>
                <p>What should be the key for current weather description?</p>
            </li>
            <li>
                <p>For other values, the JSON response returns a number, not a string. We need to cast it into
                    <code>Double</code> before using it in a meaningful string, e.g.
                </p>
                <pre><code class="language-swift">self.windString = &quot;Wind speed: \(currentObservations[&quot;temp&quot;] as! Double) mph&quot;</code></pre>
                <p>Can you find the correct key for each field (e.g. <code>"humidity"</code> for humidity)?</p>
            </li>
        </ul>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/yIXXW55gwHw?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <p>Think about following questions when you debug:</p>
        <ul>
            <li>
                <p>What is contained in jsonObjectTmp?</p>
                <p><img src="img/v4.1.jpg" alt="account" width="400" /></p>
            </li>
            <li>
                <p>What contended in currentObservations?</p>
                <p><img src="img/v4.2.jpg" alt="account" width="350" /></p>
            </li>
            <li>
                <p>What contended in currentObservations?</p>
            </li>
        </ul>
        <hr />
        <hr />

        <h5 id="video-5---adding-a-button-to-the-ux-defining-constraints">Video 5 - Adding a button to the UX, defining
            constraints</h5>
        <p>We add a new button to the interface and define its constraints.</p>
        <p><strong>We're pressing the control key while dragging from the button to the
                <code>ViewController.swift</code> file.</strong></p>
        <p>In new versions of XCode, the Library button (where you add UI elements like Button and Label) is the plus
            sign button at the top right corner instead. Also, you can show an Assistant editor by clicking Editor &gt;
            Assistant or by using the following shortcut: ⌃⌥⌘↩︎.</p>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/aT5O_qyeQGk?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <p>How do I insert a button?</p>
        <p><img src="img/v5.1.jpg" alt="account" width="500" /></p>
        <p>How to insert action? Connect button with your code?</p>
        <p>Make sure you select iPhone instead of iPad when you do simulation.</p>
        <p><img src="img/v5.2.jpg" alt="account" width="500" /></p>
        <hr />
        <hr />

        <h5 id="video-6---enabling-the-button">Video 6 - Enabling the button</h5>
        <p>This is pretty straightforward. We're making the button actually do stuff now.</p>
        <p>Again remember to press the control key (⌃) while dragging!</p>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/evw_KboMG2Q?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <hr />
        <hr />

        <h5 id="video-7---adding-more-ui-elements">Video 7 - Adding more UI Elements</h5>
        <p>We add some labels to display the weather. Note how we're using stack view here.</p>
        <p>There are at least 5 ways to lay out elements in Xcode. This is probably the fastest.</p>
        <p>Do not worry about the exact alignment of the elements too much, as long as they show up on the simulators.
            If they don't, some constraints may need to be changed or deleted (check the View Controller &gt; View &gt;
            Constraints on the left).</p>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/KWdTqycEP-E?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <p>How to group txt?</p>
        <p><img src="img/v7.1.jpg" alt="account" width="300" /></p>
        <hr />
        <hr />

        <h5 id="video-8---making-the-ui-labels-update">Video 8 - Making the UI Labels Update</h5>
        <p>We now update the UI Labels when results are fetched from the API.</p>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/r55JUaOVh7k?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <hr />
        <hr />

        <h5 id="video-9---ui-polish">Video 9 - UI Polish</h5>
        <p>This is about showing and hiding the keyboard. If the keyboard does not show up, try pressing ⌘K (Hardware
            &gt; Keyboard &gt; Toggle Software Keyboard) to see if the keyboard shows up.</p>
        <p><strong>Changes:</strong></p>
        <ul>
            <li>The keyboard type should be "Numbers and Punctuation" instead of "Number Pad", but this may not be too
                different on iPad anyway.</li>
        </ul>
        <iframe width="640" height="385" src="https://www.youtube.com/embed/kFcwheYqVKQ?rel=0" frameborder="0"
            allowfullscreen>
        </iframe>
        <p>If the keyboard does not show up, try I/0 > Keyboard > Toggle Software Keyboard) to see if the keyboard shows
            up.</p>
        <p><img src="img/v9.1.jpg" alt="account" width="600" height="300" /></p>
        <hr />
        <hr />

        <h5 id="video-10---blocks-and-async">Video 10 - Blocks and Async</h5>
        <p>Please check <a href="https://developer.apple.com/videos/play/wwdc2021/10132/">this link</a> to learn more
            about async/await in Swift</p>
        <p>We update the app to work asynchronously. Mobile devices often have very flaky connections, so it's important
            to know how to deal with them.</p>
        <p>We don't have a video here. Instead, we put the code of two important functions here. You may try them, or
            write your own.</p>
        <p>"Weather.swift": <code>fetchWeatherForZip</code> function</p>

        <pre><code class="language-swift">func fetchWeatherForZip(zip: String, completionHandler: @escaping (Bool) -&gt; Void) -&gt; Void {
    console.log("Getting for: \(zip)")
    let urlString: String = "https://api.openweathermap.org/data/2.5/weather?zip=\(zip)&amp;appid=\(APP_ID)&amp;units=imperial"

    console.log(urlString)

    let weatherURL = URL(string: urlString)

    let session = URLSession.shared
    let request = URLRequest(url: weatherURL!, cachePolicy: URLRequest.CachePolicy.useProtocolCachePolicy, timeoutInterval: 5.0)

    let task = session.dataTask(with: request, completionHandler: {(data, response, error) in
            let ret = self.parseData(data: data)
        DispatchQueue.main.async(execute: {()-&gt;Void in completionHandler(ret)})
    })

    task.resume()
}</code></pre>

        <p>"ViewController.swift" <code>getWeather</code> function (Button Handler)</p>
        <pre><code class="language-swift">@IBAction func getWeather(_ sender: UIButton) {
    NSLog(&quot;Get weather!!&quot;)
    sender.isEnabled = false
        weather.fetchWeatherForZip(zip: zip.text!, completionHandler: {(ret: Bool)-&gt;Void in
            if (ret)
            {
                NSLog(&quot;Succeeded&quot;)
                self.temp.text = String(self.weather.currentTemp)
                //add your fields here
            } else {
                NSLog(&quot;Failed&quot;)
            }
            sender.isEnabled = true
        })

    zip.resignFirstResponder()
}</code></pre>
        <p><strong>Questions(Optional):</strong> Could you write your own code to achieve Async?</p>
    </div>
    <br>


    <div class="container">
        <h5 id="submission">Submission Instructions</h5>
        Record a short video of your final result. Zip the whole project and the video as a file
        <strong>lab0_&lt;your PennKey&gt;.zip</strong>. Submit it in the gradescope.
    </div>
    <br>


    <div class="container">
        <div class="section">
            <hr>
            <br>
        </div>
    </div>

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="js/scrolling-nav.js"></script>
</body>

</html>